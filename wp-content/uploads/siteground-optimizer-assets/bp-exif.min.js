(function(){var b=!1,y=this,a=function(b){if(b instanceof a)return b;if(!(this instanceof a))return new a(b);this.EXIFwrapped=b},v,r,p,n,e,h;typeof exports!='undefined'?(typeof module!='undefined'&&module.exports&&(exports=module.exports=a),exports.EXIF=a):y.EXIF=a,v=a.Tags={0x9000:"ExifVersion",0xA000:"FlashpixVersion",0xA001:"ColorSpace",0xA002:"PixelXDimension",0xA003:"PixelYDimension",0x9101:"ComponentsConfiguration",0x9102:"CompressedBitsPerPixel",0x927C:"MakerNote",0x9286:"UserComment",0xA004:"RelatedSoundFile",0x9003:"DateTimeOriginal",0x9004:"DateTimeDigitized",0x9290:"SubsecTime",0x9291:"SubsecTimeOriginal",0x9292:"SubsecTimeDigitized",0x829A:"ExposureTime",0x829D:"FNumber",0x8822:"ExposureProgram",0x8824:"SpectralSensitivity",0x8827:"ISOSpeedRatings",0x8828:"OECF",0x9201:"ShutterSpeedValue",0x9202:"ApertureValue",0x9203:"BrightnessValue",0x9204:"ExposureBias",0x9205:"MaxApertureValue",0x9206:"SubjectDistance",0x9207:"MeteringMode",0x9208:"LightSource",0x9209:"Flash",0x9214:"SubjectArea",0x920A:"FocalLength",0xA20B:"FlashEnergy",0xA20C:"SpatialFrequencyResponse",0xA20E:"FocalPlaneXResolution",0xA20F:"FocalPlaneYResolution",0xA210:"FocalPlaneResolutionUnit",0xA214:"SubjectLocation",0xA215:"ExposureIndex",0xA217:"SensingMethod",0xA300:"FileSource",0xA301:"SceneType",0xA302:"CFAPattern",0xA401:"CustomRendered",0xA402:"ExposureMode",0xA403:"WhiteBalance",0xA404:"DigitalZoomRation",0xA405:"FocalLengthIn35mmFilm",0xA406:"SceneCaptureType",0xA407:"GainControl",0xA408:"Contrast",0xA409:"Saturation",0xA40A:"Sharpness",0xA40B:"DeviceSettingDescription",0xA40C:"SubjectDistanceRange",0xA005:"InteroperabilityIFDPointer",0xA420:"ImageUniqueID"},r=a.TiffTags={0x0100:"ImageWidth",0x0101:"ImageHeight",0x8769:"ExifIFDPointer",0x8825:"GPSInfoIFDPointer",0xA005:"InteroperabilityIFDPointer",0x0102:"BitsPerSample",0x0103:"Compression",0x0106:"PhotometricInterpretation",0x0112:"Orientation",0x0115:"SamplesPerPixel",0x011C:"PlanarConfiguration",0x0212:"YCbCrSubSampling",0x0213:"YCbCrPositioning",0x011A:"XResolution",0x011B:"YResolution",0x0128:"ResolutionUnit",0x0111:"StripOffsets",0x0116:"RowsPerStrip",0x0117:"StripByteCounts",0x0201:"JPEGInterchangeFormat",0x0202:"JPEGInterchangeFormatLength",0x012D:"TransferFunction",0x013E:"WhitePoint",0x013F:"PrimaryChromaticities",0x0211:"YCbCrCoefficients",0x0214:"ReferenceBlackWhite",0x0132:"DateTime",0x010E:"ImageDescription",0x010F:"Make",0x0110:"Model",0x0131:"Software",0x013B:"Artist",0x8298:"Copyright"},p=a.GPSTags={0x0000:"GPSVersionID",0x0001:"GPSLatitudeRef",0x0002:"GPSLatitude",0x0003:"GPSLongitudeRef",0x0004:"GPSLongitude",0x0005:"GPSAltitudeRef",0x0006:"GPSAltitude",0x0007:"GPSTimeStamp",0x0008:"GPSSatellites",0x0009:"GPSStatus",0x000A:"GPSMeasureMode",0x000B:"GPSDOP",0x000C:"GPSSpeedRef",0x000D:"GPSSpeed",0x000E:"GPSTrackRef",0x000F:"GPSTrack",0x0010:"GPSImgDirectionRef",0x0011:"GPSImgDirection",0x0012:"GPSMapDatum",0x0013:"GPSDestLatitudeRef",0x0014:"GPSDestLatitude",0x0015:"GPSDestLongitudeRef",0x0016:"GPSDestLongitude",0x0017:"GPSDestBearingRef",0x0018:"GPSDestBearing",0x0019:"GPSDestDistanceRef",0x001A:"GPSDestDistance",0x001B:"GPSProcessingMethod",0x001C:"GPSAreaInformation",0x001D:"GPSDateStamp",0x001E:"GPSDifferential"},n=a.IFD1Tags={0x0100:"ImageWidth",0x0101:"ImageHeight",0x0102:"BitsPerSample",0x0103:"Compression",0x0106:"PhotometricInterpretation",0x0111:"StripOffsets",0x0112:"Orientation",0x0115:"SamplesPerPixel",0x0116:"RowsPerStrip",0x0117:"StripByteCounts",0x011A:"XResolution",0x011B:"YResolution",0x011C:"PlanarConfiguration",0x0128:"ResolutionUnit",0x0201:"JpegIFOffset",0x0202:"JpegIFByteCount",0x0211:"YCbCrCoefficients",0x0212:"YCbCrSubSampling",0x0213:"YCbCrPositioning",0x0214:"ReferenceBlackWhite"},e=a.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0x0000:"Flash did not fire",0x0001:"Flash fired",0x0005:"Strobe return light not detected",0x0007:"Strobe return light detected",0x0009:"Flash fired, compulsory flash mode",0x000D:"Flash fired, compulsory flash mode, return light not detected",0x000F:"Flash fired, compulsory flash mode, return light detected",0x0010:"Flash did not fire, compulsory flash mode",0x0018:"Flash did not fire, auto mode",0x0019:"Flash fired, auto mode",0x001D:"Flash fired, auto mode, return light not detected",0x001F:"Flash fired, auto mode, return light detected",0x0020:"No flash function",0x0041:"Flash fired, red-eye reduction mode",0x0045:"Flash fired, red-eye reduction mode, return light not detected",0x0047:"Flash fired, red-eye reduction mode, return light detected",0x0049:"Flash fired, compulsory flash mode, red-eye reduction mode",0x004D:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",0x004F:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",0x0059:"Flash fired, auto mode, red-eye reduction mode",0x005D:"Flash fired, auto mode, return light not detected, red-eye reduction mode",0x005F:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function z(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function d(a){return!!a.exifdata}function k(b,f){var c,d,e,g,a;f=f||b.match(/^data\:([^\;]+)\;base64,/mi)[1]||'',b=b.replace(/^data\:([^\;]+)\;base64,/gmi,''),c=atob(b),d=c.length,e=new ArrayBuffer(d),g=new Uint8Array(e);for(a=0;a<d;a++)g[a]=c.charCodeAt(a);return e}function l(b,c){var a=new XMLHttpRequest;a.open("GET",b,!0),a.responseType="blob",a.onload=function(a){(this.status==200||this.status===0)&&c(this.response)},a.send()}function m(c,g){var h,e,d;function f(b){var d=i(b),e,f;c.exifdata=d||{},e=o(b),c.iptcdata=e||{},a.isXmpEnabled&&(f=x(b),c.xmpdata=f||{}),g&&g.call(c)}c.src?/^data\:/i.test(c.src)?(h=k(c.src),f(h)):/^blob\:/i.test(c.src)?(e=new FileReader,e.onload=function(a){f(a.target.result)},l(c.src,function(a){e.readAsArrayBuffer(a)})):(d=new XMLHttpRequest,d.onload=function(){if(this.status==200||this.status===0)f(d.response);else throw"Could not load image";d=null},d.open("GET",c.src,!0),d.responseType="arraybuffer",d.send(null)):self.FileReader&&(c instanceof self.Blob||c instanceof self.File)&&(e=new FileReader,e.onload=function(a){b&&console.log("Got file of length "+a.target.result.byteLength),f(a.target.result)},e.readAsArrayBuffer(c))}function i(d){var c=new DataView(d),a,f,e;if(b&&console.log("Got file of length "+d.byteLength),c.getUint8(0)!=255||c.getUint8(1)!=216)return b&&console.log("Not a valid JPEG"),!1;for(a=2,f=d.byteLength,e;a<f;){if(c.getUint8(a)!=255)return b&&console.log("Not a valid marker at offset "+a+", found: "+c.getUint8(a)),!1;if(e=c.getUint8(a+1),b&&console.log(e),e==225)return b&&console.log("Found 0xFFE1 marker"),w(c,a+4,c.getUint16(a+2)-2);a+=2+c.getUint16(a+2)}}function o(e){var d=new DataView(e),a,f,g,c,h,i;if(b&&console.log("Got file of length "+e.byteLength),d.getUint8(0)!=255||d.getUint8(1)!=216)return b&&console.log("Not a valid JPEG"),!1;for(a=2,f=e.byteLength,g=function(a,b){return a.getUint8(b)===56&&a.getUint8(b+1)===66&&a.getUint8(b+2)===73&&a.getUint8(b+3)===77&&a.getUint8(b+4)===4&&a.getUint8(b+5)===4};a<f;){if(g(d,a)){return c=d.getUint8(a+7),c%2!==0&&(c+=1),c===0&&(c=4),h=a+8+c,i=d.getUint16(a+6+c),q(e,h,i);break}a++}}h={0x78:'caption',0x6E:'credit',0x19:'keywords',0x37:'dateCreated',0x50:'byline',0x55:'bylineTitle',0x7A:'captionWriter',0x69:'headline',0x74:'copyright',0x0F:'category'};function q(k,j,l){for(var e=new DataView(k),b={},d=j,a,g,i,m,f;d<j+l;)e.getUint8(d)===28&&e.getUint8(d+1)===2&&(i=e.getUint8(d+2),i in h&&(g=e.getInt16(d+3),m=g+5,a=h[i],f=c(e,d+5,g),b.hasOwnProperty(a)?b[a]instanceof Array?b[a].push(f):b[a]=[b[a],f]:b[a]=f)),d++;return b}function f(a,j,f,k,e){var i=a.getUint16(f,!e),h={},c,g,d;for(d=0;d<i;d++)c=f+d*12+2,g=k[a.getUint16(c,!e)],!g&&b&&console.log("Unknown tag: "+a.getUint16(c,!e)),h[g]=s(a,c,j,f,e);return h}function s(d,h,m,o,e){var n=d.getUint16(h+2,!e),f=d.getUint32(h+4,!e),g=d.getUint32(h+8,!e)+m,k,b,l,a,i,j;switch(n){case 1:case 7:if(f==1)return d.getUint8(h+8,!e);k=f>4?g:h+8,b=[];for(a=0;a<f;a++)b[a]=d.getUint8(k+a);return b;case 2:return k=f>4?g:h+8,c(d,k,f-1);case 3:if(f==1)return d.getUint16(h+8,!e);k=f>2?g:h+8,b=[];for(a=0;a<f;a++)b[a]=d.getUint16(k+2*a,!e);return b;case 4:if(f==1)return d.getUint32(h+8,!e);b=[];for(a=0;a<f;a++)b[a]=d.getUint32(g+4*a,!e);return b;case 5:if(f==1)return i=d.getUint32(g,!e),j=d.getUint32(g+4,!e),l=new Number(i/j),l.numerator=i,l.denominator=j,l;b=[];for(a=0;a<f;a++)i=d.getUint32(g+8*a,!e),j=d.getUint32(g+4+8*a,!e),b[a]=new Number(i/j),b[a].numerator=i,b[a].denominator=j;return b;case 9:if(f==1)return d.getInt32(h+8,!e);b=[];for(a=0;a<f;a++)b[a]=d.getInt32(g+4*a,!e);return b;case 10:if(f==1)return d.getInt32(g,!e)/d.getInt32(g+4,!e);b=[];for(a=0;a<f;a++)b[a]=d.getInt32(g+8*a,!e)/d.getInt32(g+4+8*a,!e);return b}}function t(a,b,c){var d=a.getUint16(b,!c);return a.getUint32(b+2+d*12,!c)}function u(b,c,g,e){var d=t(b,c+g,e),a,h,i;if(d){if(d>b.byteLength)return{}}else return{};if(a=f(b,c,c+d,n,e),a.Compression)switch(a.Compression){case 6:a.JpegIFOffset&&a.JpegIFByteCount&&(h=c+a.JpegIFOffset,i=a.JpegIFByteCount,a.blob=new Blob([new Uint8Array(b.buffer,h,i)],{type:'image/jpeg'}));break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",a.Compression)}else a.PhotometricInterpretation==2&&console.log("Thumbnail image format is RGB, which is not implemented.");return a}function c(d,b,e){for(var c="",a=b;a<b+e;a++)c+=String.fromCharCode(d.getUint8(a));return c}function w(h,m){var i,j,a,d,k,g,l;if(c(h,m,4)!="Exif")return b&&console.log("Not valid EXIF data! "+c(h,m,4)),!1;if(g=m+6,h.getUint16(g)==18761)i=!1;else if(h.getUint16(g)==19789)i=!0;else return b&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;if(h.getUint16(g+2,!i)!=42)return b&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(l=h.getUint32(g+4,!i),l<8)return b&&console.log("Not valid TIFF data! (First offset less than 8)",h.getUint32(g+4,!i)),!1;if(j=f(h,g,g+l,r,i),j.ExifIFDPointer){d=f(h,g,g+j.ExifIFDPointer,v,i);for(a in d){switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":d[a]=e[a][d[a]];break;case"ExifVersion":case"FlashpixVersion":d[a]=String.fromCharCode(d[a][0],d[a][1],d[a][2],d[a][3]);break;case"ComponentsConfiguration":d[a]=e.Components[d[a][0]]+e.Components[d[a][1]]+e.Components[d[a][2]]+e.Components[d[a][3]];break}j[a]=d[a]}}if(j.GPSInfoIFDPointer){k=f(h,g,g+j.GPSInfoIFDPointer,p,i);for(a in k){switch(a){case"GPSVersionID":k[a]=k[a][0]+"."+k[a][1]+"."+k[a][2]+"."+k[a][3];break}j[a]=k[a]}}return j.thumbnail=u(h,g,l,i),j}function x(f){var e,d,m,h,i,k,a,l,g,n;if(!('DOMParser'in self))return;if(e=new DataView(f),b&&console.log("Got file of length "+f.byteLength),e.getUint8(0)!=255||e.getUint8(1)!=216)return b&&console.log("Not a valid JPEG"),!1;for(d=2,m=f.byteLength,h=new DOMParser;d<m-4;){if(c(e,d,4)=="http")return i=d-1,k=e.getUint16(d-2)-1,a=c(e,i,k),l=a.indexOf('xmpmeta>')+8,a=a.substring(a.indexOf('<x:xmpmeta'),l),g=a.indexOf('x:xmpmeta')+10,a=a.slice(0,g)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" '+'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+'xmlns:tiff="http://ns.adobe.com/tiff/1.0/" '+'xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" '+'xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" '+'xmlns:exif="http://ns.adobe.com/exif/1.0/" '+'xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" '+'xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" '+'xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" '+'xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" '+'xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+a.slice(g),n=h.parseFromString(a,'text/xml'),j(n);d++}}function g(b){var a={},d,h,e,f,c,i;if(b.nodeType==1){if(b.attributes.length>0){a['@attributes']={};for(d=0;d<b.attributes.length;d++)h=b.attributes.item(d),a['@attributes'][h.nodeName]=h.nodeValue}}else if(b.nodeType==3)return b.nodeValue;if(b.hasChildNodes())for(e=0;e<b.childNodes.length;e++)f=b.childNodes.item(e),c=f.nodeName,a[c]==null?a[c]=g(f):(a[c].push==null&&(i=a[c],a[c]=[],a[c].push(i)),a[c].push(g(f)));return a}function j(d){var a,e,c,f,j,h,i,k,b,l;try{if(a={},d.children.length>0)for(e=0;e<d.children.length;e++){c=d.children.item(e),f=c.attributes;for(j in f)h=f[j],i=h.nodeName,k=h.nodeValue,i!==void 0&&(a[i]=k);b=c.nodeName,typeof a[b]=="undefined"?a[b]=g(c):(typeof a[b].push=="undefined"&&(l=a[b],a[b]=[],a[b].push(l)),a[b].push(g(c)))}else a=d.textContent;return a}catch(a){console.log(a.message)}}a.enableXmp=function(){a.isXmpEnabled=!0},a.disableXmp=function(){a.isXmpEnabled=!1},a.getData=function(a,b){return!((self.Image&&a instanceof self.Image||self.HTMLImageElement&&a instanceof self.HTMLImageElement)&&!a.complete)&&(d(a)?b&&b.call(a):m(a,b),!0)},a.getTag=function(a,b){if(!d(a))return;return a.exifdata[b]},a.getIptcTag=function(a,b){if(!d(a))return;return a.iptcdata[b]},a.getAllTags=function(c){if(!d(c))return{};var a,b=c.exifdata,e={};for(a in b)b.hasOwnProperty(a)&&(e[a]=b[a]);return e},a.getAllIptcTags=function(c){if(!d(c))return{};var a,b=c.iptcdata,e={};for(a in b)b.hasOwnProperty(a)&&(e[a]=b[a]);return e},a.pretty=function(e){if(!d(e))return"";var a,b=e.exifdata,c="";for(a in b)b.hasOwnProperty(a)&&(typeof b[a]=="object"?b[a]instanceof Number?c+=a+" : "+b[a]+" ["+b[a].numerator+"/"+b[a].denominator+"]\r\n":c+=a+" : ["+b[a].length+" values]\r\n":c+=a+" : "+b[a]+"\r\n");return c},a.readFromBinaryFile=function(a){return i(a)},typeof define=='function'&&define.amd&&define('exif-js',[],function(){return a})}).call(this)